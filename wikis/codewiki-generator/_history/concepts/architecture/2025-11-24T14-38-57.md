---
related: [concepts/model-context-protocol-(mcp)-server.md]
updated: 2025-11-24
---

# CodeWiki-Generator Architecture

## System Overview

CodeWiki-Generator is a documentation automation system that bridges the gap between code repositories and AI-assisted development workflows. The system automatically generates, maintains, and exposes repository documentation through a [Model Context Protocol (MCP) server](../concepts/model-context-protocol-(mcp)-server.md), enabling AI agents to understand and interact with codebases more effectively. It combines wiki-style documentation generation with real-time MCP communication to create a living documentation system that evolves with the code.

## Core Architecture

The system follows a modular, event-driven architecture centered around MCP server integration. The core design separates documentation generation (wiki processing) from documentation consumption (MCP serving), with a request-response communication layer bridging AI agents and repository knowledge. The architecture emphasizes defensive programming patterns to handle the inherent unpredictability of AI interactions and dynamic repository states.

Key architectural patterns include:
- **Agent-Server Communication**: MCP JSON-RPC protocol for structured AI interactions
- **Pipeline Processing**: Sequential documentation generation and normalization
- **Gap-Driven Updates**: Reactive documentation maintenance based on identified knowledge gaps
- **Bridge Pattern**: Clean separation between wiki generation and AI query interfaces

## Major Components

### Model Context Protocol (MCP) Server Integration
The central communication hub that exposes repository knowledge to AI agents through standardized JSON-RPC protocols. Handles authentication, request routing, and response formatting while maintaining session state across interactions.

### [Wiki-to-AI Query Bridge](../components/wiki-to-ai-query-bridge.md)
Translates between human-readable wiki documentation and AI-consumable data structures. Processes natural language queries from AI agents and maps them to specific documentation sections, code components, or architectural concepts.

### [Interactive MCP client](../components/interactive-mcp-client.md)
Provides the user-facing interface for real-time interaction with the MCP server. Supports both direct queries and guided exploration of repository documentation, enabling developers to test and validate the AI integration.

### [Documentation Gap Tracking System](../components/documentation-gap-tracking-system.md)
Monitors documentation completeness by analyzing query patterns, failed lookups, and code changes. Automatically identifies areas where documentation is missing, outdated, or insufficient for AI understanding.

### [Interactive MCP Communication Pattern](../components/interactive-mcp-communication-pattern.md)
Implements the bidirectional communication flow between AI agents and the documentation system. Manages conversation context, query disambiguation, and progressive disclosure of information based on agent capabilities.

### [Markdown link normalization](../components/markdown-link-normalization.md)
Ensures consistency and validity of cross-references within generated documentation. Handles relative paths, broken links, and cross-component references to maintain navigable documentation structure.

### [MCP JSON-RPC Testing Framework](../components/mcp-json-rpc-testing-framework.md)
Provides comprehensive testing infrastructure for MCP protocol compliance, message validation, and integration scenarios. Enables automated verification of AI agent interactions and protocol conformance.

## Data Flow

The system operates through two primary data flows: documentation generation and AI query processing.

```
Repository Changes → Gap Detection → Wiki Generation → Link Normalization → MCP Server

AI Agent Query → MCP Client → Query Bridge → Documentation Lookup → Response Formatting → Agent
```

**Documentation Generation Flow**:
1. Repository changes trigger gap analysis
2. Missing or outdated documentation identified
3. Wiki content generated for gaps
4. Markdown links normalized across components
5. Updated content registered with MCP server

**AI Query Processing Flow**:
1. AI agent sends MCP JSON-RPC request
2. [Interactive MCP client](../components/interactive-mcp-client.md) validates and routes request
3. [Wiki-to-AI Query Bridge](../components/wiki-to-ai-query-bridge.md) processes natural language query
4. Relevant documentation sections retrieved and formatted
5. Response sent through MCP Communication Pattern
6. Query patterns logged for gap analysis

## Key Design Decisions

### MCP Protocol Adoption
**Choice**: Standardized Model Context Protocol for AI communication
**Rationale**: Ensures compatibility with multiple AI agents and provides structured, versioned communication interface
**Trade-offs**: Added protocol complexity but gained interoperability and future-proofing

### [Defensive Chart Rendering](../concepts/defensive-chart-rendering.md)
**Choice**: Robust error handling and graceful degradation for dynamic content
**Rationale**: AI interactions are unpredictable; system must handle malformed queries, missing data, and edge cases
**Trade-offs**: Increased code complexity but improved reliability and user experience

### Gap-Driven Documentation Updates
**Choice**: Reactive documentation generation based on actual usage patterns
**Rationale**: Prevents over-documentation while ensuring AI agents get needed information
**Trade-offs**: Some delay in documentation availability but much more efficient resource usage

### Bridge Pattern for Query Translation
**Choice**: Separate component for translating between AI queries and documentation structure
**Rationale**: Allows independent evolution of wiki format and AI interaction patterns
**Trade-offs**: Additional abstraction layer but cleaner separation of concerns

### [MCP Documentation Request System](../concepts/mcp-documentation-request-system.md)
**Choice**: Structured request/response system with defined schemas
**Rationale**: Enables reliable communication between diverse AI agents and documentation system
**Trade-offs**: More rigid than free-form queries but provides consistency and validation

## Extension Points

Developers can extend the system through several well-defined interfaces:

**Custom Documentation Generators**: Implement new wiki content generators by extending the gap detection system. Add domain-specific documentation types (API specs, architectural diagrams, test coverage reports) that integrate with the existing normalization pipeline.

**AI Agent Integrations**: Create new MCP client implementations for different AI platforms by implementing the Interactive MCP Communication Pattern. The standardized JSON-RPC interface allows integration with any agent supporting MCP.

**Query Processing Extensions**: Extend the [Wiki-to-AI Query Bridge](../components/wiki-to-ai-query-bridge.md) with custom query handlers for specialized documentation types or domain-specific knowledge extraction patterns.

**Testing Framework Plugins**: Add new test scenarios to the [MCP JSON-RPC Testing Framework](../components/mcp-json-rpc-testing-framework.md) for custom protocols, edge cases, or integration patterns specific to your AI agents.

**Gap Detection Strategies**: Implement custom gap detection algorithms in the [Documentation Gap Tracking System](../components/documentation-gap-tracking-system.md) based on code analysis, user feedback, or external documentation standards.

The modular architecture ensures extensions can be developed independently while leveraging the existing MCP infrastructure and defensive programming patterns.
