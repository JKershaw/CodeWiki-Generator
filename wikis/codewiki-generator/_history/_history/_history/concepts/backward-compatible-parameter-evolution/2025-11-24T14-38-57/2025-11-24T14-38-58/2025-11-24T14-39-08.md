---
title: Backward-compatible parameter evolution
category: concept
sourceFile: lib/processor.js
related: [components/category-based-documentation-organization.md]
created: 2025-11-24
updated: 2025-11-24
---

# Backward-compatible Parameter Evolution

## Purpose and Overview

This pattern enables the `lib/processor.js` module to gracefully evolve its API from simple string-based parameters to richer object-based parameters without breaking existing code. It allows callers to pass either legacy string concept names or new object formats with category metadata, ensuring smooth transitions in the codebase while maintaining full backward compatibility.

## Key Functionality

The backward-compatible parameter evolution pattern is implemented through two key functions:

### `processConceptDocumentation(concept, ...)`
Accepts concept parameters in two formats:
- **String format** (legacy): Direct concept name as a string
- **Object format** (new): Concept object with metadata including `name`, `category`, and other properties

The function detects the parameter type at runtime and normalizes it internally, enabling both calling conventions to work seamlessly.

### `determinePagePath(concept, ...)`
Routes documentation to appropriate wiki directories based on concept category:
- Handles both string and object-based concept parameters
- Maps categories to corresponding documentation paths:
  - `"components"` → `/components` directory
  - `"concepts"` → `/concepts` directory
  - `"guides"` → `/guides` directory
- Falls back to default behavior for legacy string parameters or unspecified categories

This two-layer approach allows the system to intelligently organize documentation while maintaining compatibility with existing callers.

## Relationships

- **`determinePagePath()`** is invoked by `processConceptDocumentation()` to compute the target wiki page location based on concept category
- **`wikiManager.getPage()` and `wikiManager.upsertPage()`** interact with the computed paths to persist categorized documentation
- The concept **category field** drives all routing decisions throughout the documentation pipeline
- **State management** tracks concept processing across the system via `mockStateManager` integration

## Usage Example

```javascript
const Processor = require('./lib/processor');
const processor = new Processor(wikiManager, stateManager);

// Legacy string-based usage (backward compatible)
await processor.processConceptDocumentation('MyComponent');

// New object-based usage with category routing
await processor.processConceptDocumentation({
  name: 'MyComponent',
  category: 'components',
  abstraction: 'medium'
});

// Both formats work seamlessly - the processor normalizes them internally
```

The processor detects the parameter type and routes the documentation appropriately:
- String `'MyComponent'` uses default routing behavior
- Object with `category: 'components'` routes to the `/components` documentation directory

## Testing

The implementation is covered by comprehensive test suites in `tests/unit/processor.test.js`:
- **26 test cases** across **6 test suites**
- Coverage includes: Processor initialization, `processCommit()`, `isSignificantFile()`, `getRelevantContext()`, `determinePagePath()`, and `processRepository()`
- The `determinePagePath` test suite specifically validates routing logic for [category-based documentation organization](../components/category-based-documentation-organization.md)